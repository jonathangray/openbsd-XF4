XCOMM $XFree86: xc/lib/X11/xlibi18n/Xi18nLib.conf,v 1.4 2002/01/17 17:14:49 dawes Exp $

#define DoNormalLib NO
#define DoSharedLib YES
#define DoDebugLib DebugLibX11
#define DoProfileLib ProfileLibX11
#define PassCDebugFlags CDEBUGFLAGS="$(CDEBUGFLAGS)"

#include <Threads.tmpl>

     SOXI18NREV = 2
     POSTLOCALE = common

#if Malloc0ReturnsNull
     MALLOC_DEFINES = -DMALLOC_0_RETURNS_NULL
#endif
#if NeedLibInsideFlag
    LIB_DEFINES = -D_XLIBINT_
#endif

DYNAMIC_DEFINES = -DDYNAMIC_LOAD
        DEFINES = $(MALLOC_DEFINES) $(LIB_DEFINES) $(SUNSOFT_DEFINES)

#include <Library.tmpl>

#ifdef HPArchitecture && OSMajorVersion > 9
    EXTRA_SHLIBLDFLAGS = +s +b $(USRLIBDIR)
#else
    EXTRA_SHLIBLDFLAGS = 
#endif

#if defined(SparcArchitecture)
#if HasSunC
CFLAGS += -xregs=no%appl
#endif
#if HasGcc
CFLAGS += -mno-app-regs
#endif
#endif

all::
	$(_NULLCMD_)
.c.o:
	$(_NULLCMD_)
	$(_NULLCMD_)
	$(_NULLCMD_)
	$(RM) $@
	$(CC) -c $(CFLAGS) $(_NOOP_) $(SHLIBDEF) $(SHAREDCODEDEF) $(PICFLAGS) $*.c

DependTarget()

clean::
	rm -rf *.so.$(SOXI18NREV)

lint::
	$(LINT) $(LINTFLAGS) $(SRCS) $(LINTLIBS)

#ifndef Xi18nLibraryTarget
#if 0
#define	Xi18nLibraryTarget(libname)		@@\
all:: libname.so.$(SOXI18NREV)			@@\
libname.so.$(SOXI18NREV): $(OBJS)		@@\
	$(RM) $@~				@@\
	(cd .; T=`echo $@ | sed 's/\.[^\.]*$$//'`; $(LD) -o ./$@~ $(SHLIBLDFLAGS) $(OBJS) $(REQUIREDLIBS) $(EXTRA_SHLIBLDFLAGS); $(RM) $$T && $(LN) $@ $$T) @@\
	$(RM) $@				@@\
	$(MV) $@~ $@				@@\
install:: libname.so.$(SOXI18NREV)		@@\
	@if [ -d $(DESTDIR)$(XLOCALEDIR)/$(POSTLOCALE) ]; then set +x; \ @@\
	else (set -x; $(MKDIRHIER) $(DESTDIR)$(XLOCALEDIR)/$(POSTLOCALE)); fi @@\
	$(RM) $(DESTDIR)$(XLOCALEDIR)/$(POSTLOCALE)/libname.so.$(SOXI18NREV)	@@\
	$(INSTALL) $(INSTALLFLAGS) $(INSTLIBFLAGS) libname.so.$(SOXI18NREV) $(DESTDIR)$(XLOCALEDIR)/$(POSTLOCALE)
#else
#define Xi18nLibraryTarget(libname)				@@\
SharedLibraryTarget(libname,$(SOXI18NREV),$(OBJS),.,.)		@@\
install:: Concat(lib,libname.so.$(SOXI18NREV))			@@\
	MakeDir($(DESTDIR)$(XLOCALEDIR)/$(POSTLOCALE))		@@\
	$(RM) $(DESTDIR)$(XLOCALEDIR)/$(POSTLOCALE)/libname.so.$(SOXI18NREV)	@@\
	$(INSTALL) $(INSTALLFLAGS) $(INSTLIBFLAGS) Concat(lib,libname.so.$(SOXI18NREV)) $(DESTDIR)$(XLOCALEDIR)/$(POSTLOCALE)/libname.so.$(SOXI18NREV)

#endif
#endif

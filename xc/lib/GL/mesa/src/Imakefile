XCOMM $XFree86: xc/lib/GL/mesa/src/Imakefile,v 1.26 2001/05/02 15:06:02 dawes Exp $

#include <Threads.tmpl>

/*
 * Only need SharedLib build unless OSMesa lib is built, or driver is built
 * in to libGL
 */
#if BuildXF86DRI && !GlxUseSGISI && \
        (GlxUseBuiltInDRIDriver || \
	 !GlxBuiltInMesa || !defined(GlxDriverUsesMesa))
#define DoNormalLib (NormalLibGlx || SharedLibGlxWithoutPIC)
#define DoSharedLib (SharedLibGlx && !SharedLibGlxWithoutPIC)
#define DoExtraLib SharedLibGlx
#define DoDebugLib DebugLibGlx
#define DoProfileLib ProfileLibGlx
#else
#define DoNormalLib SharedLibGlxWithoutPIC
#define DoSharedLib !SharedLibGlxWithoutPIC
#define DoExtraLib NO
#define DoDebugLib NO
#define DoProfileLib NO
#endif

#if Malloc0ReturnsNull
ALLOC_DEFINES = -DMALLOC_0_RETURNS_NULL
#endif

#if GlxBuiltInTdfx
 TDFX_DEFINES = -DFX
#endif

#ifdef i386Architecture
#define MesaX86BuildDir /**/
#include "X86/Imakefile.inc"
#endif
#define MesaBuildDir /**/
#define NeedToLinkMesaSrc
#include "Imakefile.inc"

#ifdef UseCompaqMathLibrary
 MATH_DEFINES = -DCCPML
#endif

      DEFINES = $(ALLOC_DEFINES) GlxDefines $(TDFX_DEFINES) \
		$(MESA_ASM_DEFINES) $(MATH_DEFINES)
     INCLUDES = -I$(INCLUDESRC) -I$(XINCLUDESRC) -I$(EXTINCSRC) \
		-I$(MESASRCDIR)/src -I$(GLXLIBSRC)/dri
         SRCS = $(COREMESASRCS)
         OBJS = $(COREMESAOBJS)

#include <Library.tmpl>

LibraryObjectRule()

SubdirLibraryRule($(OBJS))
NormalLintTarget($(SRCS))

#ifdef i386Architecture

#define IHaveSubdirs
#define PassCDebugFlags

SUBDIRS = X86

MakeSubdirs($(SUBDIRS))
DependSubdirs($(SUBDIRS))

#endif

DependTarget()
